<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_script_include">
    <sys_script_include action="INSERT_OR_UPDATE">
        <access>package_private</access>
        <active>true</active>
        <api_name>x_75086_iqm_test_2.GrToJsonConverter</api_name>
        <caller_access/>
        <client_callable>false</client_callable>
        <description/>
        <name>GrToJsonConverter</name>
        <script><![CDATA[var GrToJsonConverter = Class.create();
GrToJsonConverter.prototype = {

    convertGrToJSON: function(gr, returnValue) { // new GrToJsonConverter().convertGrToJSON(gr, 'str') // 'str' as 2nd paramter return as a string - else its an object

        var fields = this.getFields(gr);
        fields.sort();

        var recordObj = {};

        for (var field in fields) {
            var type = gr.getElement(fields[field]).getED().getInternalType();

            if (type == 'boolean' || type == 'journal_input') {

                recordObj[fields[field]] = gr.getDisplayValue(fields[field]);
            } else {

                recordObj[fields[field]] = gr.getValue(fields[field]);
            }
        }

        return returnValue == 'str' ? JSON.stringify(recordObj) : recordObj;
    },

	
    getFields: function(gr) {
       var gf = gr.getFields();  // returns a Java ArrayList...
       var flds = [];
       
       // we do sys_id manually because GlideRecord.getFields() excludes it, for reasons unknown...
       flds.push('sys_id');
       
       // move the field names into a JavaScript Array...
       for (var i = 0; i < gf.size(); i++) { 
           flds.push(gf.get(i).getName());
       }
       // skedaddle with our results...
       return flds;
    },
	
	
    initialize: function() {},

    type: 'GrToJsonConverter'
};]]></script>
        <sys_class_name>sys_script_include</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2020-09-28 15:55:50</sys_created_on>
        <sys_id>f333e6d92f6f10107a212c6df699b6a3</sys_id>
        <sys_mod_count>1</sys_mod_count>
        <sys_name>GrToJsonConverter</sys_name>
        <sys_package display_value="IQM Test 2" source="x_75086_iqm_test_2">ff2bc1fb2fc854107a212c6df699b690</sys_package>
        <sys_policy>read</sys_policy>
        <sys_scope display_value="IQM Test 2">ff2bc1fb2fc854107a212c6df699b690</sys_scope>
        <sys_update_name>sys_script_include_f333e6d92f6f10107a212c6df699b6a3</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2020-09-28 16:00:48</sys_updated_on>
    </sys_script_include>
</record_update>
